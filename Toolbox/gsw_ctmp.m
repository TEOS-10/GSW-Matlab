function result = gsw_ctmp(SA,theta)

%%   
%   result = gsw_ctmp(SA,theta)
%
%   conservative temperature from potential temperature of seawater  
%
%   SA            : Absolute Salinity                        [g/kg]
%   theta         : potential temperature with               [deg C]
%                   reference pressure of 0 dbar
%
%   result        : conservative temperature                 [deg C]

%%

if gsw_check_arrays(SA,theta)
    error('****    input array dimesnions in gsw_ctmp do not agree    ****')
end

sfac = 0.0248826675584615;                              % sfac = 1/(40*(35.16504/35)); 

x2 = sfac.*SA; x = sqrt(x2); y = theta.*0.025d0;         % normalize for F03 and F08

result =  61.01362420681071 + y.*(168776.46138048015 + ...
             y.*(-2735.2785605119625 + y.*(2574.2164453821433 + ...
                y.*(-1536.6644434977543 + y.*(545.7340497931629 + ...
                   (-50.91091728474331 - 18.30489878927802.*y).*y))))) + ...
                        x2.*(268.5520265845071 + y.*(-12019.028203559312 + ...
                            y.*(3734.858026725145 + y.*(-2046.7671145057618 + ...
                   y.*(465.28655623826234 + (-0.6370820302376359 - ...
                                            10.650848542359153.*y).*y)))) + ...
                               x.*(937.2099110620707 + y.*(588.1802812170108 + ...
                                y.*(248.39476522971285 + (-3.871557904936333 - ...
                                                       2.6268019854268356.*y).*y)) + ...
                                    x.*(-1687.914374187449 + x.*(246.9598888781377 + ...
                                x.*(123.59576582457964 - 48.5891069025409.*x)) + ...
                                                               y.*(936.3206544460336 + ...
                                          y.*(-942.7827304544439 + y.*(369.4389437509002 + ...
                                     (-33.83664947895248 - 9.987880382780322.*y).*y))))));

cp0 = 3991.86795711963;     % in concrete 02/12/08, calculated by
% cp0 = (sea_enthalpy_si(0.03516504,298.15,101325) - ...
%                                     sea_enthalpy_si(0.03516504,273.15,101325))./25;  

result = result./cp0;

end
